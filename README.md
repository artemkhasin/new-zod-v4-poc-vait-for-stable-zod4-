# React Hook Form with Zod and Dynamic Rendering POC

This project demonstrates a proof-of-concept for building dynamic forms using React Hook Form, Zod for schema definition and validation, and Material UI for components. The forms are rendered based on a configuration derived from a Zod schema.

## Project Overview

The core idea is to define a single source of truth for the form's structure, validation, and UI hints (like labels, input types) using a Zod schema. This schema is then transformed into a JSON schema-like configuration that drives the `GeneralForm` component to render the appropriate input fields.

## Key Components and Flow

1.  **Schema Definition (`src/schemas/index.ts`)**:
    *   `myZodSampleSchema`: A Zod object schema defines the form fields, their types, validation rules (e.g., `min`, `max`, `regex`, custom `refine`), and metadata (`meta`).
    *   The `meta` property on each Zod type (and on the main schema) is crucial. It stores UI-related information:
        *   `label`: Display label for the field.
        *   `description`: Helper text for the field.
        *   `inputType`: A string key (e.g., 'FormInput', 'FormDataTypeSelect') that maps to a specific React component for rendering the input.
        *   `options`: (For select/radio type inputs) An array of `{ label: string, value: string }` objects.
        *   `defaultValues`: (On the main schema's meta) An object defining the initial values for the form fields.
    *   `myFormConfig`: This is generated by `z.toJSONSchema(myZodSampleSchema)`. It converts the Zod schema into a JSON Schema representation, which `GeneralForm` uses to understand the structure and UI hints.
    *   `MyFormType`: A TypeScript type inferred from `myZodSampleSchema` for type safety.

2.  **App Component (`src/App.tsx`)**:
    *   Imports `myZodSampleSchema` and `myFormConfig`.
    *   Passes `myZodSampleSchema` to `GeneralForm` for validation purposes (via `zodResolver`).
    *   Passes `myFormConfig` (after `JSON.parse(JSON.stringify(...))` to ensure a plain object) to `GeneralForm` for rendering instructions and default values.

3.  **GeneralForm Component (`src/components/Form/GeneralForm.tsx`)**:
    *   **Props**:
        *   `formZodSchema`: The original Zod schema object.
        *   `formConfig`: The JSON schema representation derived from the Zod schema.
    *   **Form Initialization**:
        *   `useForm` from `react-hook-form` is initialized.
        *   `resolver`: `zodResolver(formZodSchema)` is used to integrate Zod validation.
        *   `defaultValues`: Taken from `formConfig.defaultValues`.
        *   `mode: "onBlur"`: Validation triggers on blur.
    *   **Form Rendering**:
        *   `formConfig.properties` (which contains the metadata for each field) is converted into an array `theFormArray`.
        *   This array is mapped over. For each field, `renderInputField` is called.
        *   `renderInputField`: A switch statement determines which input component to render based on `field.inputType` (e.g., 'FormInput', 'FormDateInput').
        *   Each specific input component (e.g., `FormInput`, `FormIdInput` located in `src/components/Form/components/`) receives props like `name`, `label`, `description`, and `options` from the `field` object.
    *   **Submission & Validation**:
        *   `handleSubmit` from `react-hook-form` wraps the `onSubmit` function.
        *   If validation (driven by `zodResolver` and `formZodSchema`) passes, the success callback with form data is invoked.
        *   If validation fails, the error callback is invoked with `validationErrors`. The `formState.errors` object should also be populated.

4.  **Form Input Components (`src/components/Form/components/`)**:
    *   These are standard controlled components integrated with `react-hook-form`'s `Controller` or by registering inputs with `register`. They receive field-specific props from `GeneralForm`. (Note: The actual implementation of these components is not detailed in the provided files but their interface is implied by `GeneralForm.tsx`).

5.  **Types (`src/components/Form/types/index.ts`)**:
    *   Defines shared TypeScript types for the form configuration (`FormSchemaType`, `FormProperty`) and input types (`FormInputType`).

## Data Flow Summary

Zod Schema (`myZodSampleSchema`)
    --(meta data)--> JSON Schema (`myFormConfig`)
        --(props)--> `GeneralForm`
            --(renders)--> Specific Input Components
            --(validation)--> `zodResolver` using `myZodSampleSchema`
                --(updates)--> `formState.errors`

## Running the Project

1.  Install dependencies: `npm install`
2.  Start the development server: `npm run dev`

## Known Issues

*   **Resolver and `formState.errors`**: There appears to be an issue where the validation errors from `zodResolver` are not being correctly propagated or reflected in `react-hook-form`'s `formState.errors` object as expected. The manual `useEffect` test in `GeneralForm.tsx` shows that the resolver itself can produce error objects when called directly, but these errors don't seem to translate into the `errors` object provided by `useForm` when interacting with the form UI. This means UI feedback for validation errors (e.g., displaying error messages next to fields) might not work correctly.
